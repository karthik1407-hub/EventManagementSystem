<div class="profile-container">
  <div class="profile-sidebar">
    <div class="user-info">
      <div class="avatar">
        <span class="avatar-letter">{{ profile?.name ? profile.name.charAt(0).toUpperCase() : '?' }}</span>
      </div>
      <div class="user-name-email">
        <h3>{{ profile?.name || (profile?.email ? profile.email.split('@')[0] : 'Your name') }}</h3>
        <p>{{ profile?.email }}</p>
      </div>
    </div>
    <nav class="profile-nav">
      <ul>
        <li><a href="#" [class.active]="!ordersVisible" (click)="$event.preventDefault(); showOrders()"><i class="fa fa-user"></i> My Profile</a></li>
        <li><a href="#" [class.active]="ordersVisible" (click)="$event.preventDefault(); toggleOrders()"><i class="fa fa-list"></i> My Orders</a></li>
        <li><a href="#" (click)="onLogout()"><i class="fa fa-sign-out-alt"></i> Log Out</a></li>
      </ul>
    </nav>
  </div>

  <div class="profile-main">
    <h2>User Profile</h2>
    <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>
    <div *ngIf="profile && !ordersVisible" class="profile-details">
      <div class="profile-row" *ngIf="!editMode">
        <label>Name</label>
        <span>{{ profile.name }}</span>
      </div>
      <div class="profile-row" *ngIf="editMode">
        <label>Name</label>
        <input [(ngModel)]="editProfile.name" [value]="profile.name" />
      </div>
      <div class="profile-row" *ngIf="!editMode">
        <label>Email account</label>
        <span>{{ profile.email }}</span>
      </div>
      <div class="profile-row" *ngIf="editMode">
        <label>Email account</label>
        <input [(ngModel)]="editProfile.email" [value]="profile.email" />
      </div>
      <div class="profile-row" *ngIf="!editMode">
        <label>Contact</label>
        <span>{{ profile.contactNumber || 'Add number' }}</span>
      </div>
      <div class="profile-row" *ngIf="editMode">
        <label>Contact</label>
        <input [(ngModel)]="editProfile.contactNumber" [value]="profile.contactNumber" />
      </div>
      <div class="profile-row">
        <label>Role</label>
        <span>{{ profile.roles }}</span>
      </div>
      <button *ngIf="editMode" class="btn-save" (click)="saveProfile()">Save Change</button>
      <button *ngIf="!editMode" class="btn-edit" (click)="toggleEdit()">Edit</button>
    </div>

    <div *ngIf="ordersVisible" class="orders-section">
      <h3>My Booking</h3>
      <div *ngIf="ordersLoading" class="loading">Loading orders...</div>
      <div *ngIf="ordersError" class="alert alert-danger">{{ ordersError }}</div>
      <table *ngIf="orders.length > 0" class="table table-bordered table-striped">
        <thead>
          <tr>
            <th>Booking ID</th>
            <th>Status</th>
            <th>Created</th>
            <th>Updated</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let order of orders">
            <td>{{ order.id }}</td>
            <td>{{ order.statusString }}</td>
            <td>{{ order.createdDate | date:'yyyy-MM-dd HH:mm:ss' }}</td>
            <td>{{ order.updatedDate | date:'yyyy-MM-dd HH:mm:ss' }}</td>
          </tr>
        </tbody>
      </table>
      <div *ngIf="!ordersLoading && orders.length === 0" class="alert alert-info">No orders found.</div>
    </div>
  </div>
</div>
