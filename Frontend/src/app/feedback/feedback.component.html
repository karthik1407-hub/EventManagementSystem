<div class="container my-4">
  
  <!-- All Feedbacks Section -->
  <div class="feedback-section">
    <h4 class="card-title mb-3">All Feedbacks</h4>
    <ul class="list-group">
      <li *ngFor="let fb of feedbacks" class="feedback-card" (click)="openFeedbackPopup(fb)" style="cursor:pointer;">
        <h5 class="mb-1">{{ getEventName(fb.eventID) }}</h5>
        <p class="mb-1"><strong>{{ fb.rating }}/5</strong></p>
      </li>
    </ul>
  </div>

  <!-- Feedback Detail Pop-up -->
  <div *ngIf="showFeedbackPopup && selectedFeedback" class="feedback-popup-overlay" (click)="closeFeedbackPopup()">
    <div class="feedback-popup" (click)="$event.stopPropagation()">
      <h4>{{ getEventName(selectedFeedback.eventID) }}</h4>
      <p><strong>Rating:</strong> {{ selectedFeedback.rating }}/5</p>
      <p><strong>Comments:</strong> {{ selectedFeedback.comments }}</p>
      <p><strong>User:</strong> {{ getUserName(selectedFeedback.userID) }}</p>
      <p><strong>Submitted:</strong> {{ selectedFeedback.submittedTimestamp | date:'medium' }}</p>
      <div *ngIf="selectedFeedback.reply" class="reply-section mb-3 p-2 bg-light border rounded">
        <strong>Organizer Reply:</strong>
        <p>{{ selectedFeedback.reply }}</p>
      </div>
      <div class="mb-3">
        <button class="btn btn-secondary me-2" (click)="editingReply = true; replyText = ''">Reply</button>
      </div>
      <div *ngIf="isOrganizer && editingReply" class="mb-3">
        <label for="replyInput" class="form-label">Add/Edit Reply</label>
        <textarea id="replyInput" class="form-control" [(ngModel)]="replyText" rows="3"></textarea>
        <button class="btn btn-primary mt-2 me-2" (click)="submitReply()">Submit Reply</button>
        <button class="btn btn-secondary mt-2" (click)="cancelReply()">Cancel</button>
      </div>
      <button class="btn btn-danger" (click)="delete(selectedFeedback.feedbackID); closeFeedbackPopup()">Delete Feedback</button>
      <button class="btn btn-secondary ms-2" (click)="closeFeedbackPopup()">Close</button>
    </div>
  </div>
</div>
